#
# Copyright (c) 2020.
#
# Confidential and Proprietary
#
# This unpublished source code may not be distributed outside
# “Independent Identity Org”. without express written permission of
# Phillip Hunt.
#
# People at companies that have signed necessary non-disclosure
# agreements may only distribute to others in the company that are
# bound by the same confidentiality agreement and distribution is
# subject to the terms of such agreement.
#
#************************************************
# Configuration for Deploying i2scim with MongoDB
#************************************************

quarkus.application.name=i2scim

quarkus.container-image.group=independentid
quarkus.container-image.name=i2scim
quarkus.container-image.builder=docker
quarkus.kubernetes.service-type=NodePort
quarkus.kubernetes.deploy=false

#quarkus.package.type=fast-jar
quarkus.kubernetes-config.config-maps=i2scim

#scim.hostname = ${SCIM_SERVER_HOST}
#scim.clustername = SCIM_CLUSTER_1
#scim.server.port=8080
#scim.server.host=localhost
#scim.server.path=/scim

# Bootstrap Schema definitions
scim.resourcetype.path=classpath:/schema/resourceTypes.json
scim.schema.path=classpath:/schema/scimSchema.json
scim.coreSchema.path=classpath:/schema/scimCommonSchema.json

#SCIM features
scim.json.pretty=true
scim.query.max.resultsize=1000
scim.bulk.max.ops=1000
scim.bulk.max.errors=5

scim.thread.count=5

scim.root.dir=/scim

#Console log
quarkus.log.min-level=FINE
#quarkus.log.category."com.independentid.scim".min-level=DEBUG

# HTTP Logging
quarkus.http.access-log.enabled=true
quarkus.http.access-log.log-to-file=true
quarkus.http.access-log.base-file-name=scim-access
quarkus.http.access-log.log-directory=${scim.root.dir}/logs

# Provider Config
#Provider selection e.g. one of...
#  - com.independentid.scim.backend.mongo.MongoProvider
#  - com.independentid.scim.backend.memory.MemoryProvider
scim.prov.providerClass=com.independentid.scim.backend.memory.MemoryProvider
scim.prov.persist.schema=true

#SCIM MongoProvider Config
scim.prov.mongo.uri=mongodb://localhost:27017
scim.prov.mongo.dbname=SCIM
scim.prov.mongo.indexes=User:userName,User:emails.value,Group:displayName


#SCIM Access Control
scim.security.enable=true
scim.security.acis=/schema/acis.json
scim.security.root.enable=true
scim.security.root.username=admin
scim.security.root.password=admin

# Basic Authentication
scim.security.authen.basic=true

# Bearer Authentication
scim.security.authen.jwt=true
scim.security.authen.jwt.claim.scope=scope

quarkus.smallrye-jwt.enabled=true

smallrye.jwt.verify.key.location=/certs/jwks-certs.json
smallrye.jwt.always-check-authorization=true
mp.jwt.verify.issuer=http://10.1.10.109:8180/auth/realms/dev



#DEVOPS and Monitoring
#quarkus.smallrye-metrics.path=
#quarkus.smallrye-metrics.extensions.enabled=true

quarkus.smallrye-metrics.path=/metrics
quarkus.smallrye-metrics.jaxrs.enabled=true



# SCIM Event Handling and Replication (must be enabled to run kafka components)
scim.event.enable=false

