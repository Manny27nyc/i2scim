#
# Copyright (c) 2020.
#
# Confidential and Proprietary
#
# This unpublished source code may not be distributed outside
# “Independent Identity Org”. without express written permission of
# Phillip Hunt.
#
# People at companies that have signed necessary non-disclosure
# agreements may only distribute to others in the company that are
# bound by the same confidentiality agreement and distribution is
# subject to the terms of such agreement.
#

#scim.hostname = ${SCIM_SERVER_HOST}
#scim.clustername = SCIM_CLUSTER_1
#scim.server.port=8080
#scim.server.host=localhost
#scim.server.path=/scim

# Bootstrap Schema definitions
scim.resourcetype.path=classpath:/schema/resourceTypes.json
scim.schema.path=classpath:/schema/scimSchema.json
scim.coreSchema.path=classpath:/schema/scimCommonSchema.json

#SCIM features
scim.json.pretty = true
scim.query.max.resultsize=1000
scim.bulk.max.ops=1000
scim.bulk.max.errors=5

scim.thread.count=5

#Console log
quarkus.log.min-level=FINE
quarkus.log.category."com.independentid.scim".min-level=DEBUG

# HTTP Logging
quarkus.http.access-log.enabled=true
quarkus.http.access-log.log-to-file=true
quarkus.http.access-log.base-file-name=scim-access
quarkus.http.access-log.log-directory=/Users/pjdhunt/scim/logs

# Provider Config
#Provider selection e.g. one of...
#  - com.independentid.scim.backend.mongo.MongoProvider
#  - com.independentid.scim.backend.memory.MemoryProvider
scim.prov.providerClass=com.independentid.scim.backend.mongo.MongoProvider
scim.prov.persist.schema=true


#SCIM Memory Provider Config
scim.prov.memory.persist.dir=./scimdata
scim.prov.memory.persist.file=scimdb.json
scim.prov.memory.maxbackups=10
scim.prov.memory.backup.mins=60
# WARNING, when enabled, test causes a database reset


#SCIM MongoProvider Config
scim.prov.mongo.uri=mongodb://localhost:27017
scim.prov.mongo.dbname = SCIM
scim.prov.mongo.indexes=User:userName,User:emails.value,Group:displayName

# WARNING, when enabled, test causes a database reset


#SCIM Access Control
scim.security.enable=true
scim.security.acis=/schema/acis.json
scim.security.root.enable=true
scim.security.root.username=admin
scim.security.root.password=admin

# Basic Authentication
scim.security.authen.basic=false

# Bearer Authentication
scim.security.authen.jwt=false
scim.security.authen.jwt.claim.scope=scope

quarkus.smallrye-jwt.enabled=true

smallrye.jwt.verify.key.location=/certs/jwks-certs.json
smallrye.jwt.always-check-authorization = true
mp.jwt.verify.issuer=http://10.1.10.109:8180/auth/realms/dev



#DEVOPS and Monitoring
#quarkus.smallrye-metrics.path=
#quarkus.smallrye-metrics.extensions.enabled=true

quarkus.smallrye-metrics.path=/metrics
quarkus.smallrye-metrics.jaxrs.enabled=true

quarkus.application.name=i2stream

# SCIM Event Handling and Replication
scim.event.enable=true



# Configure KafkaLogEventHandler
scim.kafka.log.enable=true
scim.kafka.log.bootstrap=localhost:9092

# Any Apache Producer Config property may be used with the scim.kafka.log.pub prefix
scim.kafka.log.pub.client.id=node1.log
scim.kafka.log.pub.topic=log
#scim.kafkaLogEventHandler.pub.acks=all
scim.kafka.log.pub.key.serializer=org.apache.kafka.common.serialization.StringSerializer
scim.kafka.log.pub.value.serializer=org.apache.kafka.common.serialization.StringSerializer

# Configure KafkaRepEventHandler
scim.kafka.rep.enable=false
scim.kafka.rep.client.id=node1
scim.kafka.rep.bootstrap=localhost:9092


# Configure Kafka Replication Event Publisher
# Any Apache Producer Config property may be used with the scim.kafka.rep.pub prefix
scim.kafka.rep.pub.transactional.id=${scim.kafka.rep.client.id}
scim.kafka.rep.pub.topic=rep
scim.kafka.rep.pub.acks=all
scim.kafka.rep.pub.enable.idempotence=true
scim.kafka.rep.pub.key.serializer=org.apache.kafka.common.serialization.StringSerializer
scim.kafka.rep.pub.value.serializer=com.independentid.scim.events.OperationSerializer

# Configure the Kafka Replication Event Receiver
# Any Apache Consumer Config property may be used with the scim.kafka.rep.sub prefix
#scim.kafa.rep.sub.resetdate=NONE
scim.kafka.rep.sub.group.id=SCIM-CLUSTER1
scim.kafka.rep.sub.topics=rep
scim.kafka.rep.sub.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer
scim.kafka.rep.sub.value.deserializer=com.independentid.scim.events.JsonKafkaDeserializer

#enable only for testing...
#%dev.scim.kafka.rep.sub.auto.offset.reset=latest

